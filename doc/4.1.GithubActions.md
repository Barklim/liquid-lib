---
title: Непрерывная интеграция с Github Actions
docUrl: https://github.com/features/actions
---

Теперь, когда наша библиотека компонентов строится, нам нужно найти безопасный способ публикации нашего пакета. Можно линтировать, тестировать и публиковать наш пакет локально, но это может быть сложно реализовать в более крупных командах. В этом модуле мы автоматизируем процесс публикации в среде CI / CD.

Поскольку мы храним наш репозиторий в GitHub, мы будем использовать [Действия GitHub] (https://github.com/features/actions) в качестве среды CI / CD и [Пакеты GitHub] (https://github.com/features / packages) в качестве нашего частного реестра NPM. Обе службы имеют щедрый уровень бесплатного пользования для программного обеспечения с открытым исходным кодом, а также ежемесячные кредиты для частных пакетов. Все, что мы делаем в этом модуле, будет оставаться в рамках уровня бесплатного пользования.

## GitHub Actions configuration

GitHub Actions запускает рабочие процессы на основе событий репозитория. Для нашего рабочего процесса публикации мы захотим запустить только новую версию NPM, помеченную в git (`v1`,` v2` и т. Д.).

Чтобы включить этот рабочий процесс, создайте новый файл в `.github / workflows / publish.yml`.

```bash
mkdir -p .github/workflows
touch .github/workflows/publish.yml
```

```yml
# File: .github/workflows/publish.yml

name: Publish

on:
  push:
    tags:
      - 'v*'

jobs:
  publish:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v2
    - uses: actions/setup-node@v1
      with:
        node-version: '16.x'
        registry-url: 'https://npm.pkg.github.com'
        scope: '@GITHUBUSERNAME'
    - run: npm ci
    - run: npm run lint
    - run: npm run test
    - run: npm run build
    - run: npm publish
      env:
        NODE_AUTH_TOKEN: ${{ secrets.GITHUB_TOKEN }}
```

Этот рабочий процесс `Publish` будет запускаться всякий раз, когда будет добавлен новый тег, соответствующий формату` v * `. Так и будет:


- Ознакомьтесь с нашим кодом 
- Установите последнюю версию Node v15 
- Настройте NPM для использования реестра пакетов Github 
- Используйте `npm ci`, чтобы убедиться, что установлены согласованные зависимости 
- Используйте линтер, протестируйте и соберите нашу библиотеку 
- Опубликуйте пакет в реестре пакетов Github

Поскольку действия и пакеты Github осведомлены о модели безопасности, секрет GITHUB_TOKEN будет правильно аутентифицировать нас.

**ВАЖНО:** Убедитесь, что `scope: '@ GITHUBUSERNAME'` обновлен, чтобы соответствовать вашей организации GitHub или имени учетной записи. Для моей библиотеки это будет `scope: '@barklim`.

Опубликуем нашу библиотеку компонентов в частном реестре GitHub.




