---
title: Составные компоненты
docUrl: https://kentcdodds.com/blog/compound-components-with-react-hooks
---

Шаблоны, использованные выше, хорошо подходят для простых автономных элементов. Но как только вы начнете создавать шаблоны, которые разделяют состояние между компонентами, потребуется дополнительная логика.

Создадим набор элементов управления формы в виде [составных компонентов] (https://kentcdodds.com/blog/compound-components-with-react-hooks). У этих компонентов будет общий поставщик [React Context] (https://reactjs.org/docs/context.html), который хранит автоматически сгенерированный идентификатор для доступности.

## Дизайн API

Составные компоненты - полезный шаблон проектирования, поскольку они увеличивают гибкость компонента. Давайте посмотрим на традиционный компонентный API для поля формы.

Поля часто имеют два элемента DOM: `label` и` input`. Эти поля имеют общий идентификатор, который требует от нас абстрагировать элементы до одного компонента.

```tsx
// Traditional component API
<FormField label="Standard API" placeholder="Hello" id="unique-id" />

// Renders this
<label htmlFor="unique-id">Standard API</label>
<input id="unique-id" placeholder="Hello" />
```

Этот API помогает обеспечить общий макет, но может привести к проблемам с гибкостью в будущем. Без предоставления отдельных компонентов для каждого элемента DOM потребители не могут изменять порядок элементов или стилизовать их индивидуально. Это также затрудняет обеспечение согласованных свойств для каждого элемента; будет ли событие `onClick` для элемента` label` или `input`?

Предоставление отдельных компонентов для каждого элемента позволяет потребителям изменять порядок, стили и применять свойства по мере необходимости. Эти составные компоненты могут использовать все общие шаблоны API, которые были рассмотрены ранее:

- Передача дочерних элементов JSX
- JSX prop-spreading
- React `forwardRef` API

```tsx
<Field>
  {' '}
  // Generates our unique ID
  <Field.Label>Compound API</Field.Label> // Renders a label with `htmlFor`
  attribute
  <Field.Input placeholder="Hello" /> // Renders an input with `id` attribute
</Field>
```

## React Context

И метка, и вход нуждаются в доступе к уникально сгенерированному значению идентификатора, чтобы обеспечить доступность. Это общее состояние может быть предоставлено с помощью Context API.

При визуализации компонент «Поле» сгенерирует уникальное значение идентификатора и сохранит его в состоянии. Затем он будет использовать [Context.Provider] (https://reactjs.org/docs/context.html#contextprovider), чтобы поделиться значением с любыми потребителями. В наших компонентах `Label` и` Input` мы извлечем это значение и применим его к правильным атрибутам.

## Общие утилиты

Создание уникального идентификатора может стать обычным делом для всей нашей библиотеки компонентов. Мы будем создавать настраиваемую служебную ловушку, которой в будущем можно будет поделиться с другими компонентами.

Создадим новую коллекцию компонентов и утилит `Field`, которые используют шаблон составных компонентов.
